/**
 * User: Soezen
 * Date: 1/11/13
 * Time: 18:17
 */
var fs = require('fs');

function loadFile(response, folder, filename, ext) {

    fs.readFile(relativePath(folder) + filename, function(error, html) {
        response.writeHeader(200, {"Content-Type": contentType(ext)});
        if (error) {
            response.write("ERROR: " + error);
        } else {
            response.write(html);
        }
        response.end();
    });
}

function loadHtml(response, filename) {
    loadFile(response, 'resources/html', filename, 'html');
}

function loadIcon(response, filename) {
    loadFile(response, 'resources/img/icons', filename, 'ico');
}

function contentType(ext) {
    switch (ext) {
        case 'jpg':
            return 'image/jpg';
        case 'html':
            return 'text/html';
        case 'css':
            return 'text/css';
        case 'js':
            return 'text/js';
        default:
            return 'text/plain';
    }
}

function relativePath(folder) {
    if (process.argv.indexOf('local') >= 0 && folder.indexOf('/') != 0) {
        return './app/' + folder;
    }
    return folder;
}

exports.load = loadFile;
exports.loadHtml = loadHtml;
exports.loadIcon = loadIcon;