/**
 * User: Soezen
 * Date: 31/10/13
 * Time: 20:47
 */
var logger = require('./logger');
var loader = require('./resource-loader');
var fs = require('fs');
var path = require('path');
var handle = require('./handlers.js').handle;

function route(pathname, request, response) {
    logger.debug('routing: ' + pathname);

    var ext = path.extname(pathname);
    switch (ext) {
        case '.css':
            loader.loadCss(response, pathname);
            break;
        case '.js':
            loader.loadJavascript(response, pathname);
            break;
        case '.html':
            loader.loadHtml(response, pathname);
            break;
        case '.ico':
            loader.loadIcon(response, pathname);
            break;
        default:
            if (typeof handle[pathname] === 'function') {
                return handle[pathname](request, response);
            } else {
                response.writeHead(404, {
                    "Content-Type": "text/html"
                });
                response.write('404 Not found');
                response.end();
            }
    }
}

exports.route = route;